=DSV таблицы=
Когда необходимо обработать данные в формате DSV, можно использовать класс DSV. Данный класс наследует реализацию от класса File, что позволяет управлять обрабатываемым файлом, но так же дополнен логикой парсинга DSV данных.

Для загрузки данных из целевого файла используется метод load, который может принимать в качестве единственного аргумента используемый разделитель полей записей. В качестве разделителя записей используется перенос строки (\r\n). Каждой записи присваивается уникальный, целочисленный номер (индекс), с помощью которого можно обращаться к записям файла.

Ниже приведен пример работы с DSV файлом:

  $csv = new DSV('data.csv');
  $csv->load(); // Загрузка DSV данных
  echo $csv->count(); // Количество загруженных данных
  print_r($csv->getRow(0)); // Получение первой записи.

Класс DSV так же реализует интерфейс SplSubject, что позволяет регистрировать слушателей за объектом. Это может понадобится для обработки загружаемых записей или для формирования индекса. Метод notify вызывается после загрузки каждой следующей записи. Методы getCurrentRow и getIndex возвращают текущую загружаемую запись и ее индекс соответственно.

Так же возможно изменить любую запись в файле используя метод setRow.

=Индексация=
Если необходимо сгруппировать данные в формате DSV по значениям их полей, можно воспользоваться классом Index. Индекс закрепляется за конкретным объектом DSV перед вызовом метода load и формирует ссылки на все записи по значению полей.

Ниже приведен пример использования индекса по двум полям одновременно:

  $object = new DSV('data.csv');
  $index = new Index(0, 2); // Индекс по первому и третьему полю
  $object->attach($index); // Закрепление индекса
  $object->load();
  print_r($index->getIndex('Иванов', 'Алексеевич')); // Получение идентификаторов записей, значения индексируемых полей которых соответствуют данным

Как можно заметить из примера, индекс позволяет формировать ссылки на записи DSV документа через значения индексируемых полей. Если в качестве индекса выступают два и более полей, то они индексируются вместе, касательно примера это означает, что метод getIndex вернет идентификаторы записей, поле 0 которых равно Иванов, а поле 2 равно Алексеевич.

Аналогичным образом можно определять несколько индексов для одной DSV таблицы.